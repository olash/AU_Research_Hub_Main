<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AU Research Hub</title>
    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- CSS -->
    <link href="./style.css" rel="stylesheet">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <!-- Footer CSS -->
    <link rel="stylesheet" href="css/footer.css">

</head>

<body class="font-inter">
    <!-- Header -->
    <header class="bg-white shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
            <div class="flex justify-between items-center h-16">
                <!-- Logo -->
                <a href="/">
                    <div class="flex items-center space-x-3">
                        <div class="flex items-center">
                            <div class="w-16 py-6">
                                <img src="images/AUlogo.png" alt="AU Logo">
                            </div>
                            <span class="text-xl font-medium">X</span>
                            <div class="w-14 h-14">
                                <img src="images/UNILAG.webp" alt="UNILAG logo">
                            </div>
                        </div>
                    </div>
                </a>

                <!-- Desktop Navigation -->
                <nav class="hidden md:flex items-center space-x-8">
                    <a href="/" class="text-blue-600 font-medium transition-colors">Home</a>
                    <a href="/resources" class="text-gray-700 hover:text-blue-600 transition-colors">Resources</a>
                    <a href="/gallery" class="text-gray-700 hover:text-blue-600 transition-colors">Gallery</a>
                    <a href="/initiatives.html" class="text-gray-700 hover:text-blue-600 transition-colors">Research
                        Initiatives</a>
                </nav>

                <!-- Desktop CTA and Search -->
                <div class="hidden md:flex items-center space-x-4">
                    <div class="relative">
                        <input id="globalSearchInput" type="text" placeholder="Search..." class="search-input" />
                        <div id="searchResults" class="search-results hidden"></div>
                    </div>
                    <a href="https://tally.so/r/mBVWK1">
                        <button
                            class="bgBlue text-white px-4 py-2 rounded-full text-sm font-medium transition-colors flex items-center">
                            Submit a Paper
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" style="fill: white;"
                                    d="M7 7h8.586L5.293 17.293l1.414 1.414L17 8.414V17h2V5H7v2z" />
                            </svg>
                        </button>
                    </a>
                </div>

                <!-- Mobile menu button -->
                <button id="mobile-menu-btn" class="md:hidden p-2 text-gray-400 hover:text-gray-600">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>
            </div>
        </div>

        <!-- Mobile menu -->
        <div id="mobile-menu" class="mobile-menu fixed inset-y-0 right-0 w-64 bg-white shadow-lg z-50 md:hidden">
            <div class="p-6">
                <div class="flex justify-end mb-8">
                    <button id="close-menu-btn" class="p-2 text-gray-400 hover:text-gray-600">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
                <nav class="space-y-6">
                    <a href="/" class="block text-gray-700 hover:text-blue-600 text-lg">Home</a>
                    <a href="/resources" class="block text-gray-700 hover:text-blue-600 text-lg">Resources</a>
                    <a href="/gallery" class="block text-gray-700 hover:text-blue-600 text-lg">Gallery</a>
                    <a href="/initiatives.html" class="block text-gray-700 hover:text-blue-600 text-lg">Research
                        Initiatives</a>
                    <div class="pt-6 border-t border-gray-200">
                        <a href="https://tally.so/r/mBVWK1">
                            <button
                                class="w-full bgBlue hover:bg-blue-500 text-white px-4 py-3 rounded-full text-sm font-medium transition-colors flex items-center justify-center">
                                Submit a Paper
                                <svg class="w-4 h-4 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
                                </svg>
                            </button>
                        </a>
                    </div>
                </nav>
            </div>
        </div>
    </header>

    <!-- Mobile menu overlay -->
    <div id="menu-overlay" class="fixed inset-0 bg-black bg-opacity-50 z-40 md:hidden hidden"></div>

    <!-- Hero section -->
    <section class="font-inter fade-in-section max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 lg:py-16 ">
        <div class="lg:flex lg:items-center lg:space-x-16">
            <!-- Text Content -->
            <div class="mb-8 lg:mb-0">
                <h1 class="text-4xl lg:text-5xl font-light text-gray-900 leading-tight mb-6">
                    Rebirthing the Built Environment through Interdisciplinary collaboration: Culture, Climate and
                    Heritage
                </h1>
            </div>
            <div>
                <p class="text-gray-400 text-lg mb-8 leading-relaxed">
                    At the Architecture and Urbanism Research Hub, we empower architectural innovation by curating,
                    supporting, and publishing
                    groundbreaking academic work from leading researchers around the world.
                </p>

                <div class="flex space-x-4 mt-16">
                    <a href="https://tally.so/r/mBVWK1">
                        <button
                            class="bgBlue text-white px-6 py-2.5 rounded-full text-sm font-medium hover:bg-blue-500 flex items-center space-x-2">
                            <span>Submit a Paper</span>
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" style="fill: white;"
                                    d="M7 7h8.586L5.293 17.293l1.414 1.414L17 8.414V17h2V5H7v2z" />
                            </svg>
                        </button>
                    </a>
                    <a href="/projects">
                        <button class="border txtBlue px-6 py-2.5 rounded-full text-sm font-medium hover:bg-blue-50">
                            Research Initiatives
                        </button>
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Image Section -->
    <!-- Video Section -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-12 mb-16 fade-in-section">
        <div class="relative w-full overflow-hidden rounded-2xl shadow-xl" style="padding-top: 56.25%;">
            <iframe class="absolute top-0 left-0 w-full h-full rounded-2xl"
                src="https://www.youtube.com/embed/MIBzUcHZbjo?si=154XnNlZKjXC93mZ" title="AU Research Hub"
                frameborder="0"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                allowfullscreen>
            </iframe>
        </div>
    </div>

    <!-- About Section -->
    <section class="fade-in-section max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 lg:py-16">
        <div class="mb-12">
            <span class="border txtBlue px-6 py-2 font-semibold rounded-full text-sm uppercase tracking-wide">About The
                Hub</span>
            <p class="mt-4 text-2xl font-medium leading-relaxed">
                AU Research Hub is a collaborative platform within the University of Lagos, dedicated to advancing
                architectural thought, design innovation, and scholarly discourse. Our aim is to connect researchers,
                academics, and institutions through impactful publications, symposia, and shared knowledge.
            </p>
        </div>

        <!-- Image Grid -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12 items-center">
            <img src="images/image 24.png" alt="Team meeting" class="w-full rounded-2xl object-cover">
            <img src="images/image 26.png" alt="Architecture department building"
                class="w-full rounded-2xl object-cover">
            <img src="images/image 27.png" alt="Group of students/professionals"
                class="w-full rounded-2xl object-cover">
        </div>
    </section>

    <!-- Featured Projects Section -->
    <div class="fade-in-section bg-gray-100">
        <section class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 lg:py-16">
            <div class="md:flex justify-between items-end mb-12">
                <div class="md:w-3/6">
                    <div
                        class="inline-block px-4 py-2 rounded-full text-sm text-gray-700 font-medium mb-4 border border-black uppercase">
                        Research Initiatives
                    </div>
                    <h2 class="text-4xl lg:text-5xl text-gray-900 mb-4">
                        Impact & Innovation â€”<br>
                        Our Latest Events
                    </h2>
                    <p class="text-gray-600 text-lg max-w-2xl leading-relaxed">
                        Explore our research initiatives, workshops, symposia, and collaborations shaping the future.
                    </p>
                </div>

                <div class="flex space-x-4 mt-16">
                    <a href="https://tally.so/r/mBVWK1">
                        <button
                            class="bgBlue text-white px-6 py-2.5 rounded-full text-sm font-medium hover:bg-blue-500 flex items-center space-x-2">
                            <span>Submit a Paper</span>
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" style="fill: white;"
                                    d="M7 7h8.586L5.293 17.293l1.414 1.414L17 8.414V17h2V5H7v2z" />
                            </svg>
                        </button>
                    </a>
                    <a href="/projects">
                        <button class="border txtBlue px-6 py-2.5 rounded-full text-sm font-medium hover:bg-blue-50">
                            All Initiatives
                        </button>
                    </a>
                </div>
            </div>

            <!-- Project Cards Grid -->
            <div id="initiatives-grid" class="flex max-sm:flex-col gap-8">
                <!-- Data will be injected here via script.js -->
                <div class="w-full text-center py-12 text-gray-500">Loading Initiatives...</div>
            </div>
        </section>
    </div>

    <!-- Lastest Projects Section -->
    <section class="fade-in-section max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 lg:py-16">
        <div class="md:flex justify-between items-end mb-12">
            <div class="md:w-3/6">
                <div class="inline-block px-4 py-2 rounded-full text-sm txtBlue font-medium mb-4 border uppercase">
                    Latest Publications
                </div>
                <h2 class="text-4xl lg:text-5xl text-gray-900 mb-4">
                    Featured Work from Our Community
                </h2>
                <p class="text-gray-600 text-lg max-w-2xl leading-relaxed">
                    Access the latest peer-reviewed papers, theses, and design research pushing the boundaries of the
                    built environment.
                </p>
            </div>
            <div>
                <img src="images/image 32.png" alt="" class="max-sm:hidden">
                <div class="flex space-x-4 mt-16">
                    <a href="https://tally.so/r/mBVWK1">
                        <button
                            class="bgBlue text-white px-6 py-2.5 rounded-full text-sm max-sm:text-[12px] font-medium hover:bg-blue-500 flex items-center space-x-2">
                            <span>Submit a Paper</span>
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" style="fill: white;"
                                    d="M7 7h8.586L5.293 17.293l1.414 1.414L17 8.414V17h2V5H7v2z" />
                            </svg>
                        </button>
                    </a>
                    <a href="#">
                        <button
                            class="border txtBlue px-6 py-2.5 rounded-full text-sm max-sm:text-[12px] font-medium hover:bg-blue-50">
                            Our Publications
                        </button>
                    </a>
                </div>
            </div>
        </div>

        <!-- Articles Grid Container -->
        <div class="max-w-6xl mx-auto">
            <!-- Grid Layout -->
            <div id="featuredPapers" class="grid lg:grid-cols-3 md:grid-cols-2 gap-6">
                <div class="col-span-full text-center py-12 text-gray-500">Loading Featured Papers...</div>
            </div>
        </div>
    </section>

    <!-- Team Section -->
    <div class="fade-in-section max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 lg:py-16">
        <div class="mb-12">
            <div class="inline-block bg-white px-4 py-2 rounded-full text-sm txtBlue font-medium mb-4 border uppercase">
                The Team
            </div>
            <h2 class="text-4xl lg:text-5xl text-gray-900 mb-4">
                Meet the Minds Behind the Hub
            </h2>
            <p class="text-gray-600 text-lg max-w-2xl leading-relaxed">
                Our team is composed of passionate faculty and researchers with decades of experience in architectural
                inquiry, design systems, sustainability, and spatial theory.
            </p>
        </div>

        <!-- Team Grid -->
        <div id="team-grid" class="grid grid-cols-2 md:grid-cols-3 max-sm:gap-8 md:gap-2">
            <!-- Data will be injected here via script.js -->
            <div class="col-span-full text-center py-12 text-gray-500">Loading Team...</div>
        </div>
    </div>

    <!-- Footer -->
    <!-- Footer -->
    <div id="footer"></div>

    <!-- Popup Modal -->
    <div id="popup-modal"
        class="fixed inset-0 bg-black bg-opacity-60 z-[100] hidden flex items-center justify-center p-4 backdrop-blur-sm">
        <div
            class="bg-white rounded-2xl max-w-4xl w-full overflow-hidden shadow-2xl flex flex-col md:flex-row relative transform transition-all scale-100 opacity-100">
            <button id="close-popup"
                class="absolute top-4 right-4 bg-white/50 hover:bg-white rounded-full p-2 text-gray-800 transition-colors z-20 backdrop-blur-sm">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12">
                    </path>
                </svg>
            </button>
            <div class="md:w-1/2 h-64 md:h-auto relative bg-gray-100">
                <img id="popup-image" src="" alt="Announcement" class="absolute inset-0 w-full h-full object-cover">
            </div>
            <div class="md:w-1/2 p-10 flex flex-col justify-center text-left">
                <span
                    class="inline-block px-3 py-1 bg-blue-100 text-blue-600 rounded-full text-xs font-bold mb-6 w-max uppercase tracking-wider">New
                    Announcement</span>
                <h3 id="popup-title" class="text-3xl font-bold text-gray-900 mb-4 leading-tight"></h3>
                <p id="popup-desc" class="text-gray-600 text-lg leading-relaxed mb-6"></p>
                <a id="popup-btn" href="#" target="_blank"
                    class="hidden inline-flex items-center justify-center bgBlue text-white px-6 py-3 rounded-full font-medium hover:bg-blue-600 transition-colors w-fit">
                    <span id="popup-btn-text">Learn More</span>
                    <svg class="w-4 h-4 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
                    </svg>
                </a>
            </div>
        </div>
    </div>


    <!-- Search Modal removed (replaced by inline search) -->

    <script type="module" src="script.js"></script>
    <script type="module" src="search.js"></script>
    <script type="module" src="js/footer.js"></script>
    <script type="module">
        import { supabase } from './supabase.js';

        console.log("Homepage JS loaded");

        document.addEventListener("DOMContentLoaded", () => {
            loadFeaturedPapers();
            loadTeam();
            loadInitiatives();
        });



        // Fetch Team Members
        async function loadTeam() {
            const container = document.getElementById('team-grid');
            if (!container) return;

            const { data: team, error } = await supabase
                .from('team_members')
                .select('*')
                // .eq('is_active', true)
                .order('created_at', { ascending: true });

            console.log("TEAM DATA:", team);
            console.log("TEAM ERROR:", error);

            if (error) {
                console.error("Error fetching team:", error);
                container.innerHTML = `<div class="col-span-full text-center py-12 text-gray-500">Error loading team: ${error.message}</div>`;
                return;
            }

            if (!team || team.length === 0) {
                container.innerHTML = '<div class="col-span-full text-center py-12 text-gray-500">No team members found (check filters).</div>';
                return;
            }

            container.innerHTML = team.map(member => `
                <div class="text-center group">
                    <div class="mb-6 relative">
                        <div class="team-avatar">
                            <img src="${member.image_url || 'images/default-avatar.png'}" alt="${member.name}">
                        </div>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-900 mb-1">${member.name}</h3>
                    <p class="text-gray-500 font-medium mb-4">${member.role}</p>
                    <div class="flex justify-center space-x-3">
                        ${member.instagram ? `
                        <a href="${member.instagram}" target="_blank"
                            class="w-10 h-10 bg-white border border-gray-200 rounded-full flex items-center justify-center hover:bg-gray-50 transition-colors">
                            <i class="fab fa-instagram text-gray-600"></i>
                        </a>` : ''}
                        ${member.twitter ? `
                        <a href="${member.twitter}" target="_blank"
                            class="w-10 h-10 bg-white border border-gray-200 rounded-full flex items-center justify-center hover:bg-gray-50 transition-colors">
                            <i class="fab fa-twitter text-gray-600"></i>
                        </a>` : ''}
                        ${member.linkedin ? `
                        <a href="${member.linkedin}" target="_blank"
                            class="w-10 h-10 bg-white border border-gray-200 rounded-full flex items-center justify-center hover:bg-gray-50 transition-colors">
                            <i class="fab fa-linkedin-in text-gray-600"></i>
                        </a>` : ''}
                    </div>
                </div>
            `).join('');
        }



        // Fetch Featured Initiatives
        async function loadInitiatives() {
            const container = document.getElementById('initiatives-grid');
            if (!container) return;

            const { data: initiatives, error } = await supabase
                .from('initiatives')
                .select('*')
                // .eq('is_featured', true)
                .order('created_at', { ascending: false })
                .limit(3);

            console.log("INITIATIVES DATA:", initiatives);
            console.log("INITIATIVES ERROR:", error);

            if (error) {
                console.error("Error fetching initiatives:", error);
                container.innerHTML = `<div class="w-full text-center py-12 text-gray-500">Error loading initiatives: ${error.message}</div>`;
                return;
            }

            if (!initiatives || initiatives.length === 0) {
                container.innerHTML = '<div class="w-full text-center py-12 text-gray-500">No initiatives found (check filters).</div>';
                return;
            }

            container.innerHTML = initiatives.map(item => `
                 <div class="flex-1 transition-all duration-300 ease-in-out hover:flex-[3] rounded-2xl overflow-hidden group">
                    <div class="relative">
                        <img src="${item.image_url}" alt="${item.title}"
                            class="w-full h-96 object-cover bg-gray-100">
                    </div>
                    <div class="py-6">
                        <h3 class="text-xl font-medium text-gray-900 mb-4 line-clamp-2">${item.title}</h3>

                        <div class="grid grid-cols-3 gap-y-3 text-sm">
                            <div>
                                <span class="text-gray-500 block text-xs">Category</span>
                                <span class="text-gray-900">${item.category}</span>
                            </div>
                            <div>
                                <span class="text-gray-500 block text-xs">Year</span>
                                <span class="text-gray-900">${item.year}</span>
                            </div>
                            <div>
                                <span class="text-gray-500 block text-xs">Location</span>
                                <span class="text-gray-900">${item.location}</span>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Fetch Featured Papers (Dynamic)
        async function loadFeaturedPapers() {
            const container = document.getElementById("featuredPapers");
            if (!container) return;

            // Schema check: papers usually have 'created_at'. User requested 'published_date'. 
            // I will select * to be safe and use 'created_at' for sort if published_date missing.
            const { data, error } = await supabase
                .from("papers")
                .select("id, title, author, created_at, cover_image, category, pdf_url")
                // .eq("published", true)
                .order("created_at", { ascending: false })
                .limit(3);

            console.log("FEATURED PAPERS (BOTTOM) DATA:", data);
            console.log("FEATURED PAPERS (BOTTOM) ERROR:", error);

            if (error) {
                container.innerHTML = `<div class='col-span-full text-center py-12 text-gray-500'>Error loading featured papers: ${error.message}</div>`;
                return;
            }

            if (!data || data.length === 0) {
                container.innerHTML = "<div class='col-span-full text-center py-12 text-gray-500'>No featured papers yet (check filters).</div>";
                return;
            }

            container.innerHTML = data.map(paper => `
            <article class="bg-white rounded-2xl overflow-hidden shadow-sm hover:shadow-lg transition-shadow duration-300 border border-gray-100 flex flex-col h-full">
                <!-- Image Container -->
                <div class="relative bg-gray-200 h-48">
                    ${paper.cover_image
                    ? `<img src="${paper.cover_image}" alt="${paper.title}" class="w-full h-full object-cover">`
                    : `<div class="w-full h-full flex items-center justify-center bg-gray-100"><i class="fas fa-file-alt text-4xl text-gray-300"></i></div>`
                }
                    <!-- Category Tag -->
                    <div class="absolute top-4 left-4">
                        <span class="bg-white/90 backdrop-blur-sm text-gray-800 px-3 py-1 rounded-full text-xs font-medium">
                            ${paper.category || 'Research'}
                        </span>
                    </div>
                </div>

                <!-- Content -->
                <div class="py-4 px-4 flex-grow flex flex-col">
                    <h3 class="text-lg font-bold text-gray-900 mb-3 leading-tight line-clamp-2">
                        ${paper.title}
                    </h3>

                    <div class="text-sm mb-4 text-gray-600 font-medium mt-auto">
                        <div class="mb-4">
                            <span>By ${paper.author}</span>
                        </div>
                        <div class="flex items-center space-x-1">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z">
                                </path>
                            </svg>
                            <span>${new Date(paper.created_at).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</span>
                        </div>
                    </div>

                    <a href="${paper.pdf_url}" target="_blank">
                        <button class="w-full flex items-center justify-center space-x-2 bg-white px-4 py-2 rounded-full text-sm text-gray-700 font-bold mb-4 border border-gray-200 hover:bg-gray-50 transition-colors">
                            <span>Read More</span>
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
                            </svg>
                        </button>
                    </a>
                </div>
            </article>
          `).join("");
        }


    </script>
</body>

</html>